{#
    TODO: Post Edit
    - example /home/edit_post/17696015
    - data will be passed from route.
    - check that required fields are not editable by disabling those fields.
    - ensure post save method filters out changes that should not be made such as ,
    changing the post type.
#}

{% extends '../layout/layout.html' %}

{% block content %}
    {% parent %}
    <div class="new_post row">
        <div class="row">
            <h2 class="post-header-title text-center columns large-12">{{ data.title }}</h2>
        </div>
        <hr class="section-divider" />
        <div class="row">
            <form method="POST" action="/actions" class="columns large-10 large-offset-1" id="post_edit" ref="post_edit_form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label>Select type of Post</label>
                        <div class="button-bar" data-post-buttongroup>
                            {% include "../partials/post_types.html" with {
                                name: 'type',
                                value: data.post.type.typeId || 1,
                                postTypes: [
                                  { name: 'Offer', value: 1 },
                                  { name: 'Wanted', value: 3 },
                                  { name: 'Lend', value: 9 },
                                  { name: 'Borrow', value: 10 }
                                ]
                              } only
                            %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Post title</label>
                        <input name="subject" type="text" value="{{ data.post.subject }}" />
                    </div>
                    <div class="form-group">
                        <div class="uploads row">
                            {% for imageURL in data.post.images %}
                                <img src="{{ imageURL }}" />
                            {% endfor %}
                        </div>
                        <label>Upload New Pictures</label>
                        <input name="images" type="file" multiple />
                    </div>
                    <div class="form-group">
                        <label>Post to Local Town</label>
                        <div class="input-with-icon">
                            <input type="text" name="town" value="{{ data.post.group.name }}" />
                            <span class="iconcenter">
                                {% include '../icons/map_pin.html' %}
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Post to Local Town</label>
                        <div class="input-with-icon">
                            <select class="select-post-town" name="town" data-width="100%">
                              {% for town in data.towns %}
                                {% if data.post.group.id === town.id %}
                                  <option value="{{town.id}}" selected="selected">{{town.name}}</option>
                                {% else %}
                                  <option value="{{town.id}}" >{{town.name}}</option>
                                {% endif %}
                              {% endfor %}
                            </select>
                            <span class="iconcenter">
                                {% include '../icons/map_pin.html' %}
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <fc-editor name="description" value="{{ data.post.description }}"></fc-editor>
                    </div>
                    <div class="form-group">
                        <label>Tags</label>
                        <select class="select-new-post-tags" name="tags" multiple="multiple" data-width="100%">
                          {% for tag in data.tags %}
                            {% if data.post.tags.includes(tag.id) %}
                              <option value="{{tag.id}}" selected="selected">{{tag.name}}</option>
                            {% else %}
                              <option value="{{tag.id}}">{{tag.name}}</option>
                            {% endif %}
                          {% endfor %}
                        </select>
                    </div>
                    <div class="form-group text-center">
                        <button type="submit" role="submit" class="btn-default btn-wide">Post Item</button>
                    </div>
                </div>
            </form>
        </div>
        <hr class="section-divider" />
    </div>
    {% include '../partials/in_body_banner_row.html'%}

{% endblock %}
