{# Note: This file is provided by the fc3_common_assets package #}
<div class="post-detail-item" style="width: 100%; padding: 20px;" >
	<div class="row" style= >
		<div class="columns medium-8">
			<div class="row">
				<div class="columns small-6 left">
					<div class="post-detail-item-category-icon">
						{% include "./post_type.html" with { post : post } %}
					</div>
					{% if post.share && !post.share.returnDate %}
					{% if post|lendOverdue %}
					<p class="callout warning">
						Item Overdue!{% if post.share.dueDate %} It was due on {{ post.share.dueDate|formatDate('M-D-YYYY') }}.{%
						endif %}
						{% if me.id === post.user.id %}<a href="/home/my-replies?type=post&id={{post.id}}">Message your friend</a>{%
						endif %}
					</p>
					{% else %}
					<p class="callout success">
						{% if me.id === post.user.id %}
						On Loan!
						{% elseif me.id === post.share.borrowerId %}
						BORROWED
						{% endif %}

						{% if post.share.dueDate %}Due back on {{ post.share.dueDate|formatDate('M-D-YYYY') }}.{% endif %}</span>
					</p>
					{% endif %}
					{% endif %}
				</div>
			</div>
			<div class="row" style="margin-left: 10px;" >
				<h4 class="section-title left">
					{{post.subject}}
				</h4>
			</div>
			<div class="post-detail-item-content">
				<div class="post-detail-item-content-header" style="border: none;" >
					<div class="columns medium-12">
						
						<div class="clearfix"  style="margin-top: 10px;"></div>
						<div class="row">
							<ul class="post-items" style="margin-left: 0px; color: #c9c6c0;" >
								{% set datetimeOpts = { time: post.time, timezone: post.group.timezone }%}
								<li><span><i class="fa fa-map-signs"></i> {{post.location|title }}</span></li>
								<li><span>{{ post.date|mreldate(datetimeOpts)|title }}</span></li>
								<li><span>{{ post.date|mdate(datetimeOpts, 'MM/DD/YYYY')}}</span></li>
								<li><span>#{{post.id}}</span></li>
							</ul>
							<div class="row" style="margin: 0px;" >
								<hr/>
							</div>
							<ul class="post-items" style="margin-left: 0px;" >
								{% if post.group %}
								<li>
									<a href="{{path.groups_main}}{{post.group.uniqueName}}">
										<fc-icon name="towns" style="cursor: default; display: inline; position: relative; top: 3px;" width="20"></fc-icon>
										<span>{{ post.group.uniqueName|upper }}</span>
									</a>
								</li>
								{% endif %}
								<li>
									<a href="{{path.user}}{{post.user.username}}">
										<img src="{{global.imagesURL}}/user/{{post.userId}}/thumb" class="fc-avatar" style="padding: 1px; height: 20px; width: 20px;"/>
										<span>{{ post.user.username|upper }}</span>
									</a>
								</li>
								<li>
									<fc-icon name="tag" style="cursor: default; display: inline; position: relative;"></fc-icon> <span style="font-weight: bold;">TAGS</span>&nbsp;
									{% for tag in post.tags %}
									{# TODO where ought this link go? #}
									{% set tag.url = path.home_dashboard + '?tags=' + tag.name %}
									<a href="{{tag.url}}">{{tag.name}}</a>{% if !loop.last %}, {% endif %}
									{% endfor %}
								</li>
								{% if post.static && post.static.lendDuration %}
								<li>
									<strong>Lend Duration</strong>
									<span>{{ post.static.lendDuration }} Days</span>
								</li>
								{% endif %}
							</ul>
						</div>
					</div>
				</div>
				<div class="post-detail-item-content-description align-left">
					<div class="container"  style="font-style: bold;">
						<strong>{{ post.description|sanitizeHtml|raw }}</strong>
					</div>
					<br />
					<hr/>
					<div class="container" style="margin-top: 40px; position: relative;">
						{% if session %}
						{% if session.id === post.user.id %}
						<a href="/home/edit-post/{{post.id}}" class="btn-action" style="float: left; margin-right: 10px;">Edit</a>
						{% elseif post.blocked %}
						{# show nothing if the poster has blocked me #}
						{% elseif post.canReply %}
						<fc-messages-detail-input topic-type="post" :topic-id="Number({{ post.id }})" custom-trigger='<button class="btn-{{ post.type.name|lower }}" style="float: left; margin-right: 10px;" >{{ postAction|default('Reply') }}</button>'>
							<p><strong>New Message Re:</strong> {{ post.description|sanitizeHtml|raw }}</p>
						</fc-messages-detail-input>
						{% else %}
						<a href="{{path.groups_main}}{{post.group.uniqueName}}" style="float: left; margin-right: 10px;" >
							Join the {{ post.group.name }} group</a> to reply to this post.
						{% endif %}
						{% else %}
						<fc-modal id="login" custom-trigger='<a style="float: left; margin-right: 10px;" >Login to reply to this post</a>'>
							<fc-login></fc-login>
						</fc-modal>
						{% endif %}
						<div class="btn-borrow fab" style="float: left; margin-right: 10px; line-height: 1; height: 44px; width: 68px;" >
							<span class="text">Share</span>
							<social-sharing :url="`${$root.currentUrl}?utm_source=social&utm_medium=post-detail`" title="Freecycle: {{post.subject}}" description="{{post.description|sanitizeHtml|raw|striptags}}" hashtags="freecycle,freecycle3" inline-template>
								<div>
									<network network="facebook"> <div class="option fb"> <i class="fa fa-facebook"></i> </div> </network>
									<network network="twitter"> <div class="option twitter"> <i class="fa fa-twitter"></i> </div> </network>
								</div>
							</social-sharing>
							<div class="option delete"><i class="fa fa-trash"></i></div>
							<div class="close"><i class="fa fa-times"></i></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="columns medium-4 right">
			{% if post.images %}
			{# Use carousel only if multiple images #}
			{% if post.images.length > 1 %}
			{% include "./post_images_carousel.html" with { images: post.images } %}
			<div class="row text-center">
				<fc-modal type="custom" custom-trigger='<a @click.prevent="">View Images Full Size</a>'>
					{% include "./post_images_carousel.html" with { images: post.images, modal: true } %}
				</fc-modal>
			</div>
			{% elseif post.images.length === 1 %}
			<div class="row">
				<div class="post-detail-item-photo">
					<img src="{{ post.images[0] }}" style="width: 600px !important; object-fit: cover; max-height: 300px;">
				</div>
			</div>
			<div class="row text-center">
				<fc-modal type="custom" custom-trigger='<a @click.prevent="">View Image Full Size</a>'>
					<img src="{{ post.images[0] }}" style="width: 600px !important;" />
				</fc-modal>
			</div>
			{% endif %}
			{% endif %}
		</div>
	</div>
</div>